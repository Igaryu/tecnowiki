
<h1 class="sectionedit1" id="configurazione_firewall_su_nostri_server_di_posta">Configurazione FireWall su nostri server di posta</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configurazione FireWall su nostri server di posta&quot;,&quot;hid&quot;:&quot;configurazione_firewall_su_nostri_server_di_posta&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-64&quot;} -->
<h2 class="sectionedit2" id="attenzionequeste_regole_sono_obbligatorie_pena_il_non_funzionamento_del_sistema">ATTENZIONE: Queste regole sono → obbligatorie ←  pena il non funzionamento del sistema.</h2>
<div class="level2">
<hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;ATTENZIONE: Queste regole sono \u2192 obbligatorie \u2190  pena il non funzionamento del sistema.&quot;,&quot;hid&quot;:&quot;attenzionequeste_regole_sono_obbligatorie_pena_il_non_funzionamento_del_sistema&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;65-174&quot;} -->
<h2 class="sectionedit3" id="regole_di_firewalling">Regole Di Firewalling</h2>
<div class="level2">

<p>
Sui nostri server di posta, per default, installiamo delle regole di firewall a fine installazione. Le regole attive sono sulle seguenti porte:
</p>
<div class="table sectionedit4"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> NR.</th><th class="col1"> Porta </th><th class="col2 leftalign">Servizio        </th><th class="col3 leftalign">Note                                                  </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> 1 </td><td class="col1 leftalign"> 60000  </td><td class="col2 leftalign"> servizio SSH   </td><td class="col3 leftalign"> Spostamento porta da quella di default per SSH/SFTP  </td>
	</tr>
	<tr class="row2">
		<td class="col0"> 2 </td><td class="col1 centeralign">    80  </td><td class="col2 leftalign"> server http    </td><td class="col3 leftalign"> Accesso per Webmail e Amministrazione                </td>
	</tr>
	<tr class="row3">
		<td class="col0"> 3 </td><td class="col1 centeralign">   443  </td><td class="col2 leftalign"> server https   </td><td class="col3 leftalign"> Transito in SSL per Webmail e Amministrazione        </td>
	</tr>
	<tr class="row4">
		<td class="col0"> 4 </td><td class="col1 centeralign">   587  </td><td class="col2 leftalign"> server SMTPS   </td><td class="col3 leftalign"> SMTP sotto STARTTLS                                  </td>
	</tr>
	<tr class="row5">
		<td class="col0"> 5 </td><td class="col1 centeralign">   993  </td><td class="col2 leftalign"> server IMAP4S  </td><td class="col3 leftalign"> IMAP4 sotto SSL/TLS                                  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;355-877&quot;} -->
<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Regole Di Firewalling&quot;,&quot;hid&quot;:&quot;regole_di_firewalling&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;175-882&quot;} -->
<h2 class="sectionedit5" id="come_inserire_e_cancellare_delle_regole_di_firewalling">Come inserire, e cancellare, delle regole di firewalling</h2>
<div class="level2">
<hr />

<p>
Le regole, ovviamente, possono cambiare da server a server, a seconda delle necessità del cliente. Queste sono quelle di default.<br/>

Per semplificare l&#039;inserimento, e la manutenzione, delle regole viene usata l&#039;interfaccia CLI<sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup> di ufw <sup><a href="#fn__2" id="fnt__2" class="fn_top">2)</a></sup> nel seguente modo:
</p>
<ul>
<li class="level1"><div class="li"><em><strong>ufw allow porta/tcp</strong></em> oppure <strong><em>ufw allow servizio</em></strong>: inserisce regola (<em>servizio</em>=SMTP o IMAP ecc. ecc.)</div>
</li>
<li class="level1"><div class="li"><strong><em>ufw status numbered</em></strong>: fornisce il numero di righe delle regole necessario per la cancellazione</div>
</li>
<li class="level1"><div class="li"><strong><em>ufw delete #</em></strong> (con # = numero della regola da cancellare) cancella la regola numero #</div>
</li>
</ul>

<p>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Come inserire, e cancellare, delle regole di firewalling&quot;,&quot;hid&quot;:&quot;come_inserire_e_cancellare_delle_regole_di_firewalling&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;883-1651&quot;} -->
<h2 class="sectionedit6" id="avvio_e_spegnimento_del_firewall_usando_ufw">Avvio e spegnimento del firewall usando ufw</h2>
<div class="level2">
<hr />

<p>
Infine per sospendere e riavviare il servizio di firewall:
</p>
<ul>
<li class="level1"><div class="li">  <strong><em>ufw disable</em></strong>: Disabilita il firewall ed anche il suo caricamento nei successivi reboot<br/>
</div>
</li>
<li class="level1"><div class="li">  <strong><em>ufw enable</em></strong>:  Abilita il firewall ed anche il suo caricamento nei successivi reboot</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Avvio e spegnimento del firewall usando ufw&quot;,&quot;hid&quot;:&quot;avvio_e_spegnimento_del_firewall_usando_ufw&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;1652-1975&quot;} -->
<h2 class="sectionedit7" id="nota_importante_sulla_sequenza">Nota importante sulla sequenza!</h2>
<div class="level2">
<hr />

<p>
La sequenza qui riportata, ossia dichiarare <strong>prima</strong> le regole e <strong>solo dopo</strong> attivare il firewall non è una svista o un errore: se siete connessi da remoto, ed avviate il firewall <strong>prima di aver inserito le regole</strong> resterete bloccati fuori! In quel caso l&#039;unica soluzione sarà raggiungere fisicamente il server per poter operare da console fisica dello stesso.
</p>

<p>
Questo perché noi normalmente, spostiamo la porta di ascolto del demone di SSH dal valore di default ad un valore tra 50000 e l&#039;ultima porta disponibile. Se avvierete il firewall <strong>prima</strong> di aver inserito la regola dedicata ad <strong>ssh</strong>, nella tabella all&#039;inizio di questa pagina la regola numero uno, verrete avvisati dal sistema operativo che se proseguirete con l&#039;attivazione del firewall rischiate di restare <em>chiusi fuori</em> dal sistema: se confermerete la vostra decisione di attivare il firewall e <strong>non avete ancora inserito la regola inerente la nuova porta di ssh</strong> resterete tagliati fuori, <strong>se siete connessi da remoto</strong>. 
</p>

<p>
Nemmeno un reboot eseguito da remoto sarebbe d&#039;aiuto: l&#039;avvio del firewall attraverso <strong>ufw enable</strong> oltre ad avviare il firewall, lo configura in modo tale da avviarsi automaticamente <strong>ad ogni riavvio</strong>.
</p>

<p>
Quindi la sequenza riportata è corretta:
</p>
<ul>
<li class="level1"><div class="li">Prima si inserisce <strong>almeno</strong> la regola che punta alla porta che abbiamo configurato per ssh;</div>
</li>
<li class="level1"><div class="li">Poi si lancia, e conferma, l&#039;attivazione del firewall.</div>
</li>
</ul>

<p>
<br/>
<br/>

</p>
<hr />

<p>
<a href="/doku.php?id=configurazioni" class="wikilink1" title="configurazioni" data-wiki-id="configurazioni">Clicca qui per tornare alla pagina delle Configurazioni</a><br/>

<a href="/doku.php?id=start" class="wikilink1" title="start" data-wiki-id="start">Clicca qui per tornare alla home page del Wiki</a>
</p>
<hr />

<p>
 — <em><a href="mailto:&#106;&#99;&#117;&#114;&#116;&#111;&#64;&#106;&#111;&#101;&#46;&#118;&#114;&#46;&#105;&#116;" class="mail" title="&#106;&#99;&#117;&#114;&#116;&#111;&#64;&#106;&#111;&#101;&#46;&#118;&#114;&#46;&#105;&#116;">Joseph Curto</a> 2018/07/16 08:56</em> – Ultimo aggiornamento 2023/07/26 11:10
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Nota importante sulla sequenza!&quot;,&quot;hid&quot;:&quot;nota_importante_sulla_sequenza&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;1976-&quot;} --><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
<div class="content">da terminale via linea di comando</div></div>
<div class="fn"><sup><a href="#fnt__2" id="fn__2" class="fn_bot">2)</a></sup> 
<div class="content"><strong><em>apt install ufw</em></strong> per l&#039;installazione fosse assente dal sistema</div></div>
</div>
